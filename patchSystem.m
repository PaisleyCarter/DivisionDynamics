function p = patchSystem(r,IN)

n=length(r);
[R,V,C] = ComputeVoronoiPBC(r);
xlim([-1, 5]);
ylim([-1, 5]);


[A,P] = CellPolyareaPerimeter(V,C);
avgA = mean(A(1:n,:));
M=ceil(max(A(1:n,:)));

for i=1:n
  Dev = A(i) - avgA;
  patch(V(C{i},1),V(C{i},2), Dev);
end 

for i=1:n
    Ci = [num2str(i)];
    text(r(i,1), r(i,2), Ci)
end


%%Purple color map
col=[255,178,206;
255,178,206;
255,178,207;
254,177,207;
254,177,208;
253,177,208;
253,177,209;
252,177,209;
251,177,210;
251,177,210;
250,177,211;
250,177,211;
249,176,212;
249,176,212;
248,176,213;
248,176,214;
247,176,214;
247,176,215;
246,176,215;
245,176,216;
245,176,216;
244,175,217;
244,175,217;
243,175,218;
243,175,218;
242,175,219;
242,175,219;
241,175,220;
241,175,220;
240,175,221;
239,174,222;
239,174,222;
238,174,223;
238,174,223;
237,174,224;
237,174,224;
236,174,225;
236,174,225;
235,174,226;
235,173,226;
234,173,227;
233,173,227;
233,173,228;
232,173,228;
232,173,229;
231,173,230;
231,173,230;
230,173,231;
230,172,231;
229,172,232;
229,172,232;
228,172,233;
227,172,233;
227,172,234;
226,172,234;
226,172,235;
225,172,235;
225,172,236;
224,171,236;
224,171,237;
223,171,238;
223,171,238;
222,171,239;
221,171,239;
221,171,240;
221,170,240;
220,169,240;
220,168,240;
220,168,240;
220,167,241;
219,166,241;
219,165,241;
219,165,241;
219,164,241;
218,163,241;
218,162,242;
218,162,242;
218,161,242;
217,160,242;
217,159,242;
217,159,243;
217,158,243;
216,157,243;
216,157,243;
216,156,243;
216,155,243;
215,154,244;
215,154,244;
215,153,244;
215,152,244;
214,151,244;
214,151,245;
214,150,245;
214,149,245;
213,148,245;
213,148,245;
213,147,245;
213,146,246;
212,145,246;
212,145,246;
212,144,246;
212,143,246;
211,142,247;
211,142,247;
211,141,247;
211,140,247;
210,140,247;
210,139,247;
210,138,248;
209,137,248;
209,137,248;
209,136,248;
209,135,248;
208,134,249;
208,134,249;
208,133,249;
208,132,249;
207,131,249;
207,131,249;
207,130,250;
207,129,250;
206,128,250;
206,128,250;
206,127,250;
206,126,251;
205,125,251;
205,125,251;
205,124,251;
204,123,250;
204,121,249;
203,119,248;
202,118,246;
202,116,245;
201,114,243;
200,113,242;
200,111,240;
199,109,239;
198,108,238;
198,106,236;
197,104,235;
196,103,233;
195,101,232;
195,99,230;
194,98,229;
193,96,228;
193,94,226;
192,92,225;
191,91,223;
191,89,222;
190,87,220;
189,86,219;
189,84,218;
188,82,216;
187,81,215;
186,79,213;
186,77,212;
185,76,210;
184,74,209;
184,72,208;
183,71,206;
182,69,205;
182,67,203;
181,66,202;
180,64,200;
180,62,199;
179,60,197;
178,59,196;
177,57,195;
177,55,193;
176,54,192;
175,52,190;
175,50,189;
174,49,187;
173,47,186;
173,45,185;
172,44,183;
171,42,182;
171,40,180;
170,39,179;
169,37,177;
168,35,176;
168,33,175;
167,32,173;
166,30,172;
166,28,170;
165,27,169;
164,25,167;
164,23,166;
163,22,165;
162,20,163;
162,18,162;
161,17,160;
160,17,160;
160,17,160;
160,18,159;
160,18,159;
159,19,159;
159,20,158;
159,20,158;
158,21,158;
158,21,158;
158,22,157;
157,23,157;
157,23,157;
157,24,157;
156,24,156;
156,25,156;
156,26,156;
155,26,156;
155,27,155;
155,27,155;
154,28,155;
154,29,155;
154,29,154;
153,30,154;
153,30,154;
153,31,154;
152,32,153;
152,32,153;
152,33,153;
151,33,153;
151,34,152;
151,34,152;
150,35,152;
150,36,152;
150,36,151;
149,37,151;
149,37,151;
149,38,151;
148,39,150;
148,39,150;
148,40,150;
147,40,150;
147,41,149;
147,42,149;
146,42,149;
146,43,149;
146,43,148;
145,44,148;
145,45,148;
145,45,148;
144,46,147;
144,46,147;
144,47,147;
143,48,147;
143,48,146;
143,49,146;
142,49,146;
142,50,146;
142,51,145;
142,51,145;
141,52,145;
141,52,144;
141,53,144;
140,53,144;
140,54,144];

%Define the colormap
colormap(col/255);
c=colorbar;
c.Label.String= 'Cell Area Deviation';

for k=1:length(IN)
    cell = IN(k);
    p= patch(V(C{cell},1),V(C{cell},2), 'white');
    p.EdgeColor='white';
end 


end 